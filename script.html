<script type="text/javascript">
      var map;
      var kmlLayer = null;
      var riderLayer = null;
      var queryLayer = null;
      var currentLayer = null;
      var center = new google.maps.LatLng(39.828200, -98.579500);

  var lowNum;
  var query1;
  var query2;

      function initialize() {

        // Define Style
        var newStyle = [{"elementType":"geometry","stylers":[{"color":"#c1fcb8"},{"weight":"1.00"}]},{"elementType":"labels","stylers":[{"visibility":"off"}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"elementType":"labels.text.fill","stylers":[{"lightness":20},{"gamma":0.01}]},{"elementType":"labels.text.stroke","stylers":[{"saturation":-31},{"lightness":-33},{"gamma":0.8},{"weight":2}]},{"featureType":"administrative","elementType":"geometry","stylers":[{"hue":"#ff0000"},{"visibility":"off"}]},{"featureType":"administrative","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"administrative.country","stylers":[{"visibility":"off"}]},{"featureType":"administrative.country","elementType":"geometry.stroke","stylers":[{"color":"#808080"},{"visibility":"on"}]},{"featureType":"administrative.province","elementType":"geometry.stroke","stylers":[{"color":"#804040"},{"visibility":"on"}]},{"featureType":"administrative.province","elementType":"labels.text","stylers":[{"color":"#808080"},{"visibility":"on"},{"weight":1}]},{"featureType":"administrative.province","elementType":"labels.text.fill","stylers":[{"color":"#606060"}]},{"featureType":"administrative.province","elementType":"labels.text.stroke","stylers":[{"color":"#ffffff"},{"visibility":"on"}]},{"featureType":"landscape","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"poi","stylers":[{"color":"#e0ffd3"}]},{"featureType":"poi","elementType":"geometry","stylers":[{"saturation":20}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"saturation":-20},{"lightness":20}]},{"featureType":"poi.park","elementType":"geometry.fill","stylers":[{"color":"#41ff82"},{"visibility":"on"}]},{"featureType":"road","stylers":[{"weight":"2.00"}]},{"featureType":"road","elementType":"geometry","stylers":[{"color":"#57aa9f"},{"saturation":"-67"},{"lightness":"-20"},{"gamma":"1.32"},{"visibility":"simplified"},{"weight":"2.00"}]},{"featureType":"road","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"weight":"2.00"}]},{"featureType":"road","elementType":"geometry.stroke","stylers":[{"color":"#f1ff8a"},{"saturation":25},{"lightness":25},{"visibility":"on"},{"weight":"1.00"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"},{"weight":"2.12"}]},{"featureType":"road.arterial","elementType":"geometry.fill","stylers":[{"color":"#4c98a8"},{"weight":"2.63"}]},{"featureType":"road.arterial","elementType":"geometry.stroke","stylers":[{"color":"#f1ff8a"}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#4c98a8"},{"visibility":"on"}]},{"featureType":"road.highway","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"transit.line","stylers":[{"visibility":"off"}]},{"featureType":"transit.station","stylers":[{"visibility":"off"}]},{"featureType":"water","stylers":[{"color":"#1b89d9"},{"lightness":-20}]},{"featureType":"water","elementType":"geometry.fill","stylers":[{"color":"#1b87d9"}]},{"featureType":"water","elementType":"labels","stylers":[{"visibility":"off"}]}];

        var customStyleVar = new google.maps.StyledMapType(newStyle, {name: "Pokemon!"});	//Creates a new map style from "newStyle" and names it "Blue Night". This style is referenced by "customStyleVar".

          var mapDiv = document.getElementById('googft-mapCanvas');
          map = new google.maps.Map(mapDiv, {
              center: center,
              zoom: 4,
              disableDefaultUI: true,
              mapTypeControl: true,
              mapTypeControlOptions: {
    						mapTypeIds: ['roadmap', 'hybrid', 'styled_map1'],	// adds "styled_map1" to map type menu, but labels it by the name deifned in line 21 "What? Pokemon!"
    					},
          });
          // Add new map style to map
          map.mapTypes.set('styled_map1', customStyleVar);	// Ceates a new map type called "styled_map1" from "customStyleVar"
          map.setMapTypeId('styled_map1');	//Sets map's default type to "styled_map1". Default style can be set to: roadmap, satellite, hybrid, terrain. Only custom styles need quotes.
          // Add KML Layer

          url = "https://raw.githubusercontent.com/hzxsoytc/Web-Mapping-Final/master/GeoData/2016%20ToH%20Memorial%20by%20State.kml";
          clearLayer();
          kmlLayer = new google.maps.KmlLayer(url, {
              map: map,
              preserveViewport: true
          });
          currentLayer = kmlLayer;
          map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(document.getElementById('googft-legend-open'));
          map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(document.getElementById('googft-legend'))
      }

      function passVar1() {
          lowNum = document.getElementById("lowNum").value;
          highNum = document.getElementById("highNum").value;
          query1 = "col7 >= " + lowNum + " and " + "col7 <= " + highNum;
          queryLayer.setOptions({
              query: {
                  select: "Flag",
                  from: "1wEi1klGCHS_9RxFmIrxgcWqZO4jYCv8SSGxxUGre",
                  where: query1
              }
          });
      }

      function passVar2() {
          flagNum = document.getElementById("flagNum").value;
          query2 = "Flag = " + flagNum;
          riderLayer.setOptions({
              query: {
                  select: "Flag",
                  from: "1sIH9DhpWJqagN5UkKqBUfUz3MTezl_acw4luDSPJ",
                  where: query2
              }
          });
      }

      function reset1(){
          queryLayer.setOptions({
              query: {
                  select: "Flag",
                  from: "1wEi1klGCHS_9RxFmIrxgcWqZO4jYCv8SSGxxUGre"
              }
  })}

      function reset2(){
          riderLayer.setOptions({
              query: {
                  select: "Flag",
                  from: "1sIH9DhpWJqagN5UkKqBUfUz3MTezl_acw4luDSPJ"
              }
          })}

      function riderF() {
          //map.setCenter(center);
          //map.setZoom(5);
          clearLayer();
          riderLayer = new google.maps.FusionTablesLayer({
              map: map,
              heatmap: { enabled: false },
              query: {
                  select: "Flag",
                  from: "1sIH9DhpWJqagN5UkKqBUfUz3MTezl_acw4luDSPJ",
                  where: ""
              }
          });
          riderLayer.setMap(map);
          currentLayer = riderLayer;
      }

      function queryF() {
          //map.setCenter(center);
          //map.setZoom(5);
          clearLayer();
          queryLayer = new google.maps.FusionTablesLayer({
              map: map,
              heatmap: { enabled: false },
              query: {
                  select: "Flag",
                  from: "1wEi1klGCHS_9RxFmIrxgcWqZO4jYCv8SSGxxUGre",
                  where: ""
              }
          });
          queryLayer.setMap(map);
          currentLayer = queryLayer;
      }

      function kmlF() {
          url = "https://raw.githubusercontent.com/hzxsoytc/Web-Mapping-Final/master/GeoData/2016%20ToH%20Memorial%20by%20State.kml";
          clearLayer();
          kmlLayer = new google.maps.KmlLayer(url, {
              map: map,
              preserveViewport: true
          });
          currentLayer = kmlLayer;
      }

      function clearLayer() {
          if (currentLayer != null) {
              currentLayer.setMap(null);
          }
      }

      google.maps.event.addDomListener(window, 'load', initialize);
</script>
